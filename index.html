<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<title>MomoFlow</title>
  <!--[if IE]><script type="text/javascript" src="js/excanvas.compiled.js"></script><![endif]-->
  <script type="text/javascript" src="js/jquery-1.3.2.js"></script>
  <script type="text/javascript" src="js/ui.core.js"></script>
  <script type="text/javascript" src="js/ui.slider.js"></script>
  <script type="text/javascript" src="js/momoflow.js"></script>
  <link   type="text/css"       href="css/ui.all.css" rel="stylesheet" />
  <script type="text/javascript">

    $(document).ready(function() {

      var images = [ 'images/01sedcard.jpg', 'images/02sedcard.jpg', 'images/03sedcard.jpg', 'images/04sedcard.jpg', 'images/05sedcard.jpg', 'images/06sedcard.jpg', 'images/07sedcard.jpg', 'images/08sedcard.jpg', 'images/09sedcard.jpg', 'images/10sedcard.jpg', ];

      init();

      /*
        var jsonFlickrFeed = function(o) {
          for (var i=0; i<10; i++){ images.push(o.items[i].media.m); }
          init();
        }

        $.ajax( {
          url: 'http://api.flickr.com/services/feeds/photos_public.gne?tags=face&lang=en-us&format=json&size=b',
          success: function(o){ eval(o); }     
        });
      */

      function init(){
        var cf = new CF(
          $('#container'), images, {
            onSetPosition : function(index){
              $('#slider').slider('option', 'value', index);
            },

            onclick: function(element, index, geometry) {
              var pos = $(element).offset();
              var img = document.createElement('img');
              var max = Math.min($(window).width(), $(window).height()) - 100;
              var w   = geometry.w;
              var h   = geometry.h;

              img.src = images[index];
              $(img).css({
                position: 'absolute',
                left:   pos.left,
                top:    pos.top + geometry.y,
                width:  w,
                height: h,
                zIndex: 10000
              });

              var fac    = (w > h) ? max / w : max / h;
              var wNew   = w * fac; 
              var hNew   = h * fac;

              document.body.appendChild(img);

              $('#container').animate({
                opacity: 0.3
              }, 200);
              $(img).animate({
                width:  wNew,
                height: hNew,
                left:   pos.left - (wNew - w) / 2,
                top:    ($(window).height() - hNew) / 2
              }, 200, 'swing', 
                function(){ 
                  $(document).bind('click', function clk(){
                    $(document).unbind('click', clk);
                    $('#container').animate({
                      opacity: 1
                    }, 200);
                    $(img).animate({
                        width:  w,
                        height: h,
                        left:   pos.left,
                        top:    pos.top + geometry.y
                      }, 200, 'swing', function(){
                        $(img).remove();
                      }
                    );
                  }); 
                }
              );
            }
          }
        );

        $('#slider').slider({
          animate:  true,
          min:      0,
          max:      images.length - 1,
          change : function(event, s){
            cf.setPosition(s.value)
          }
        });
      }

		});
	</script>

  <style type="text/css" media="screen">
    body    { 
      background-color: #aaaaaa; 
    }

    canvas  { 
      border: 0px solid blue; 
    }

    #slider {
      width: 400px;
      margin: auto;
    }

    #container {
      background-color: #aaaaaa; 
      position:         relative;
      border:           0px solid red;
      height:           400px;
      margin:           auto;
      margin-top :      100px;
      margin-bottom :   40px;
      overflow:         hidden;
    }
	</style>


</head>
  <body>
    <div id="container"></div>
    <div id="slider"></div>
  </body>
</html>
